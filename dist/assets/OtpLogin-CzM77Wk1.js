import{k as S,d as p,u as C,e as _,l as w,c as o,a as s,j as x,g as d,w as v,v as c,t as g,i as b,b as h,h as V,r as P,o as i}from"./index-QZaKag1-.js";import{_ as L}from"./logo-Bn_1feJI.js";const T={class:"login-inner-card"},R={class:"card"},E={class:"form-item mb-16"},N={key:0,class:"err-msg"},U={key:0,class:"form-item mb-16"},A={key:0,class:"err-msg"},B={class:"remember-row flex align-center justify-space gap-16 mb-16"},D={key:0,class:"send-again"},H={key:0,class:"code-msg"},j={class:"submit-btn"},M={key:0,type:"submit",class:"btn primary-btn w-100"},$={key:1,type:"submit",class:"btn primary-btn w-100"},G={class:"reg-row flex align-center gap-16"},z={__name:"OtpLogin",setup(K){S("");const a=C(),r=p(()=>a.state.Auth),t=_({submit:!1,submitOtp:!1,loginId:null,input1:null,input2:null,input3:null,input4:null,otp:"",time:30,timerRunning:!1,intervalId:null});w(()=>{r.value.otpStatus=!1});const y=()=>{if(r.value.otpStatus){if(m.value){t.submitOtp=!0;return}t.submitOtp=!1,a.dispatch("Auth/crmVerifyOtp",{loginId:t.loginId,otp:t.otp,roles:"SCHOOL"})}else{if(u.value){t.submit=!0;return}t.submit=!1,f(),a.dispatch("Auth/crmLogin",{loginId:t.loginId,password:null,roles:"SCHOOL",passwordStatus:!1})}};function k(){if(u.value){t.submit=!0;return}t.submit=!1,f(),a.dispatch("Auth/crmLogin",{loginId:t.loginId,password:null,roles:"SCHOOL",passwordStatus:!1})}function f(){t.timerRunning=!0,t.time=30,t.intervalId=setInterval(()=>{t.time>1?t.time--:(clearInterval(t.intervalId),t.timerRunning=!1)},1e3)}const u=p(()=>{if(!t.loginId)return"Please Enter Your Registered Phone Number"}),m=p(()=>{if(t.otp){if(t.otp.length!=4)return"Pleade Enter Valid OTP !"}else return"Please Enter OTP!"});function I(n){let e=String.fromCharCode(n.keyCode);if(/^[0-9]+$/.test(e)||n.keyCode===8||n.keyCode===9||n.keyCode===37||n.keyCode===39||n.keyCode>=96&&n.keyCode<=105)return!0;n.preventDefault()}return(n,e)=>{const O=P("router-link");return i(),o("div",T,[e[11]||(e[11]=s("div",{class:"logo"},[s("img",{src:L,alt:""})],-1)),s("div",R,[s("form",{class:"form",onSubmit:x(y,["prevent"])},[e[8]||(e[8]=s("div",{class:"login-heading"},[s("h3",null,"Sign In")],-1)),s("div",E,[e[4]||(e[4]=s("div",{class:"title text-white"},"User Id",-1)),v(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>t.loginId=l),placeholder:"Enter User Id",maxlength:"30"},null,512),[[c,t.loginId]]),t.submit&&u.value?(i(),o("div",N,g(u.value),1)):d("",!0)]),r.value.otpStatus?(i(),o("div",U,[e[5]||(e[5]=s("div",{class:"title"},"OTP",-1)),v(s("input",{type:"text",name:"otp","onUpdate:modelValue":e[1]||(e[1]=l=>t.otp=l),placeholder:"Enter OTP",maxlength:"4",onKeydown:e[2]||(e[2]=l=>I(l))},null,544),[[c,t.otp]]),t.submit&&m.value?(i(),o("div",A,g(m.value),1)):d("",!0)])):d("",!0),s("div",B,[e[7]||(e[7]=s("label",{for:"check",class:"text-small flex align-center gap-10 pointer"},null,-1)),r.value.otpStatus?(i(),o("div",D,[e[6]||(e[6]=b(" Didn't get it ? ")),t.timerRunning?(i(),o("strong",H,"Resend Code in "+g(t.time)+" Seconds",1)):(i(),o("strong",{key:1,class:"resend",onClick:e[3]||(e[3]=l=>k())},"Resend OTP"))])):d("",!0)]),s("div",j,[r.value.otpStatus?(i(),o("button",M," Sign In ")):(i(),o("button",$," Get Otp In "))])],32)]),s("div",G,[e[10]||(e[10]=s("div",{class:"text text-grey"},"Login Via Password",-1)),h(O,{to:"/login",class:"btn white-btn"},{default:V(()=>e[9]||(e[9]=[b("Login")])),_:1})])])}}};export{z as default};
