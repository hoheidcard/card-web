import{k as F,d as R,u as x,e as E,n as B,p as P,l as V,c as n,a as e,b as s,j as p,t as b,h as c,r as f,s as j,o as a,g as _}from"./index-QZaKag1-.js";import{_ as D}from"./no-image-Cge9pZ0v.js";import{C as L}from"./cropper-DXBHp5yS.js";const q={class:"profile-layout"},N={class:"container"},W={class:"left-card card"},$={class:"top-info"},H=["src"],G={key:1,src:D,alt:""},J={class:"info"},K={class:"name"},Q={class:"about f-w-bold"},T={class:"bottom-links bottom-links-desk"},X={class:"icon"},Y={class:"icon"},Z={class:"icon"},tt={class:"icon"},et={class:"icon"},ot={class:"right-card card"},st={class:"image-upload-crop"},it={key:0},nt=["src"],at={key:1},rt=["src"],lt={class:"modal-footer"},ct={class:"btns"},gt={__name:"StaffProfileLayout",setup(dt){const v=F(null),d=x(),g=P();j();const u=R(()=>d.state.OrganizationStaff),t=E({staffAccountId:null,settingId:null,cropModal:!1,imageUrl:null,imageFile:null,croppedImageUrl:null,cropper:null,cropperEnable:!1,type:""});B(()=>{g.query.id&&(t.staffAccountId=g.query.id,t.settingId=g.query.settingId,S(),z())}),V(()=>{t.cropper&&t.cropper.destroy()});const k=()=>{t.cropper&&t.cropper.destroy(),t.cropperEnable=!1},h=()=>{t.cropper&&t.cropper.destroy(),t.cropperEnable=!0;const i=v.value;t.cropper=new L(i,{aspectRatio:35/45,viewMode:1})},C=i=>{t.imageFile=i.target.files[0],t.imageFile&&t.imageFile.type.startsWith("image/")&&(t.imageUrl=URL.createObjectURL(t.imageFile))},y=()=>{const i=t.cropper.getCroppedCanvas();t.croppedImageUrl=i.toDataURL()};async function w(){if(!t.cropperEnable)d.dispatch("OrganizationStaff/updateProfileImage",{id:t.staffAccountId,file:t.imageFile});else{const i=t.cropper.getCroppedCanvas(),o=await new Promise(l=>i.toBlob(l)),r=new File([o],"cropped-image.png",{type:"image/png"});d.dispatch("OrganizationStaff/updateProfileImage",{id:t.staffAccountId,file:r})}t.cropModal=!1}function U(){t.cropModal=!0}function S(){d.dispatch("OrganizationStaff/getOneStaff",{id:t.staffAccountId})}function z(){d.dispatch("OrganizationSettings/getOneOrganizationSettings",{id:t.settingId})}return(i,o)=>{var I;const r=f("icon-right-arrow"),l=f("router-link"),M=f("router-view"),O=f("icon-cross"),A=f("Modal");return a(),n("section",q,[e("div",N,[e("div",W,[e("div",$,[e("div",{class:"img",onClick:p(U,["prevent"])},[u.value.profile?(a(),n("img",{key:0,src:u.value.profile,alt:""},null,8,H)):(a(),n("img",G))]),e("div",J,[e("div",K,[o[3]||(o[3]=e("div",{class:"text"},"Welcome,",-1)),e("h3",null,b(u.value.name),1)]),e("div",Q,b((I=u.value.designation)==null?void 0:I.name),1)])]),e("div",T,[s(l,{to:"/crm/organization-staff-profile?id="+t.staffAccountId+"&settingId="+t.settingId,class:"profile-link"},{default:c(()=>[o[4]||(o[4]=e("div",{class:"title"},"Profile",-1)),e("div",X,[s(r)])]),_:1},8,["to"]),s(l,{to:"/crm/organization-staff-class-students?id="+t.staffAccountId+"&settingId="+t.settingId,class:"profile-link"},{default:c(()=>[o[5]||(o[5]=e("div",{class:"title"},"Students",-1)),e("div",Y,[s(r)])]),_:1},8,["to"]),s(l,{to:"/crm/organization-staff-department?id="+t.staffAccountId+"&settingId="+t.settingId,class:"profile-link"},{default:c(()=>[o[6]||(o[6]=e("div",{class:"title"},"Department",-1)),e("div",Z,[s(r)])]),_:1},8,["to"]),s(l,{to:"/crm/organization-staff-subject?id="+t.staffAccountId+"&settingId="+t.settingId,class:"profile-link"},{default:c(()=>[o[7]||(o[7]=e("div",{class:"title"},"Subject",-1)),e("div",tt,[s(r)])]),_:1},8,["to"]),s(l,{to:"/crm/organization-staff-documents?id="+t.staffAccountId+"&settingId="+t.settingId,class:"profile-link"},{default:c(()=>[o[8]||(o[8]=e("div",{class:"title"},"Documents",-1)),e("div",et,[s(r)])]),_:1},8,["to"])])]),e("div",ot,[s(M)])]),s(A,{show:t.cropModal,"onUpdate:show":o[2]||(o[2]=m=>t.cropModal=m),class:"status-modal",headerClasses:"header-bg"},{header:c(()=>[o[9]||(o[9]=e("div",{class:"title",showHeader:"true"},"Upload Image",-1)),e("div",{class:"close-btn",onClick:o[0]||(o[0]=p(m=>t.cropModal=!1,["prevent"]))},[s(O)])]),default:c(()=>[e("div",st,[e("input",{type:"file",onChange:C},null,32),t.imageUrl?(a(),n("div",it,[e("img",{ref_key:"imageRef",ref:v,src:t.imageUrl,alt:"Source Image",style:{"max-width":"100%"}},null,8,nt),o[10]||(o[10]=e("br",null,null,-1)),t.cropperEnable?(a(),n("button",{key:0,type:"button",class:"btn green-btn",onClick:y}," Crop Image ")):_("",!0),o[11]||(o[11]=e("br",null,null,-1))])):_("",!0),t.croppedImageUrl?(a(),n("div",at,[e("img",{src:t.croppedImageUrl,alt:"Cropped Image",style:{"max-width":"100%",height:"150px"}},null,8,rt)])):_("",!0)]),e("div",lt,[e("div",ct,[e("div",{class:"btn red-btn",onClick:o[1]||(o[1]=p(m=>t.cropModal=!1,["prevent"]))}," Cancel "),t.cropperEnable?(a(),n("div",{key:1,class:"btn green-btn",onClick:p(k,["prevent"])}," Crop ")):(a(),n("div",{key:0,class:"btn green-btn",onClick:p(h,["prevent"])}," Crop ")),e("div",{class:"btn white-btn",onClick:w},"Upload")])])]),_:1},8,["show"])])}}};export{gt as default};
