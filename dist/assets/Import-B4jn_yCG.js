import{k as S,d as h,u as _,e as y,n as z,p as b,l as w,c,a as e,i as d,b as x,r as C,g as I,I as P,t as O,j as V,s as U,o as p}from"./index-QZaKag1-.js";const k={class:"section import-page"},B={class:"container"},D={class:"main-card mid-cardd"},F={class:"card-header"},j={class:"left"},N={class:"icon"},A={class:"card-body flex justify-center"},L={class:"import-data flex flex-d-col align-center text-center w-90 p-6-r"},R={key:0,class:"cssProgress"},q={class:"progress3"},M=["data-percent"],H={class:"cssProgress-label"},T={class:"text text-grey mb-16 w-50"},E={for:"list",class:"flex justify-center"},Z={__name:"Import",setup(J){const n=_(),r=b();S([]),U();const l=h(()=>n.state.OrganizationSettings),s=y({submit:!1,organizationId:null,organizationSettingId:null,file:null,uploadPercentage:0,progressStatus:!1});z(()=>{r.query.id&&(s.organizationId=r.query.id,s.organizationSettingId=r.query.settingId,u())}),w(()=>{s.progressStatus=!1,s.uploadPercentage=0});function u(){n.dispatch("OrganizationSettings/getOneOrganizationSettings",{id:s.organizationSettingId})}const g=o=>{s.uploadPercentage=Math.round(o.loaded*100/o.total)};async function f(o){if(o){s.progressStatus=!1,s.uploadPercentage=0;const t=o.target.files[0];if(t.type.endsWith("zip")||t.type==="application/x-zip-compressed"){const i=new FormData;i.append("file",t),s.progressStatus=!0,n.dispatch("OrganizationStudent/uploadStudentCsvFile",{organizationDetailId:s.organizationId,settingId:s.organizationSettingId,files:i,onUploadProgress:g,type:"SCHOOL"}),o.target.value=null}else n.dispatch("Alert/error",{msg:"Upload file in zip format."})}else n.dispatch("Alert/error",{msg:"Upload file in zip format."})}const m=o=>o.join(",")+`
`,v=()=>{if(l.value.studentCsvFields){const o=m(JSON.parse(l.value.studentCsvFields)),t=new Blob([o],{type:"text/csv"}),i=window.URL.createObjectURL(t),a=document.createElement("a");a.href=i,a.setAttribute("download","data.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}else n.dispatch("Alert/error",{msg:"Please select csv fields from setting."})};return(o,t)=>{const i=C("icon-download");return p(),c("div",k,[e("div",B,[e("div",D,[e("div",F,[e("div",j,[e("div",N,[x(i,{class:"rotate-18"})]),t[1]||(t[1]=d(" Import Students "))]),t[2]||(t[2]=e("div",{class:"right"},[e("div",{class:"text text-grey"})],-1))]),e("div",A,[e("div",L,[s.progressStatus?(p(),c("div",R,[e("div",q,[e("div",{class:"cssProgress-bar cssProgress-active","data-percent":s.uploadPercentage,style:P({width:s.uploadPercentage+"%"})},[e("span",H,O(s.uploadPercentage)+"%",1)],12,M)])])):I("",!0),t[6]||(t[6]=e("h4",{class:"mb-16"},"Import Students Data",-1)),e("div",T,[t[3]||(t[3]=d(" If the university or SCHOOL is aware of these cases, they can monitor the ")),e("a",{class:"text-primary text-small f-w-bold pointer",onClick:V(v,["prevent"])},"Download CSV File"),t[4]||(t[4]=d(" & Upload it where threats found "))]),e("label",E,[e("input",{type:"file",id:"list",class:"d-none",accept:".zip",onChange:t[0]||(t[0]=a=>f(a))},null,32),t[5]||(t[5]=e("div",{class:"btn white-btn"},"Upload ZIP File",-1))])])])])])])}}};export{Z as default};
