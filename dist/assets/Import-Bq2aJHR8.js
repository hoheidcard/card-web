import{k as h,d as S,u as _,e as y,n as z,p as b,l as w,c,a as e,i as l,b as x,r as I,g as C,I as P,t as O,j as V,s as U,o as p}from"./index-QZaKag1-.js";const k={class:"section import-page"},B={class:"container"},D={class:"main-card mid-cardd"},F={class:"card-header"},j={class:"left"},N={class:"icon"},A={class:"card-body flex justify-center"},R={class:"import-data flex flex-d-col align-center text-center w-90 p-6-r"},q={key:0,class:"cssProgress"},L={class:"progress3"},M=["data-percent"],T={class:"cssProgress-label"},E={class:"text text-grey mb-16 w-50"},H={for:"list",class:"flex justify-center"},Z={__name:"Import",setup(J){const n=_(),r=b();h([]),U();const d=S(()=>n.state.OrganizationSettings),s=y({submit:!1,organizationId:null,organizationSettingId:null,file:null,uploadPercentage:0,progressStatus:!1});z(()=>{r.query.id&&(s.organizationId=r.query.id,s.organizationSettingId=r.query.settingId,f())}),w(()=>{s.progressStatus=!1,s.uploadPercentage=0});function f(){n.dispatch("OrganizationSettings/getOneOrganizationSettings",{id:s.organizationSettingId})}const g=o=>{s.uploadPercentage=Math.round(o.loaded*100/o.total)};async function u(o){if(o){s.progressStatus=!1,s.uploadPercentage=0;const t=o.target.files[0];if(t.type.endsWith("zip")||t.type==="application/x-zip-compressed"){const i=new FormData;i.append("file",t),s.progressStatus=!0,n.dispatch("OrganizationStaff/uploadStaffCsvFile",{organizationDetailId:s.organizationId,settingId:s.organizationSettingId,files:i,onUploadProgress:g}),o.target.value=null}else n.dispatch("Alert/error",{msg:"Upload file in zip format."})}else n.dispatch("Alert/error",{msg:"Upload file in zip format."})}const m=o=>o.join(",")+`
`,v=()=>{if(d.value.staffCsvFields){const o=m(JSON.parse(d.value.staffCsvFields)),t=new Blob([o],{type:"text/csv"}),i=window.URL.createObjectURL(t),a=document.createElement("a");a.href=i,a.setAttribute("download","data.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}else n.dispatch("Alert/error",{msg:"Please select csv fields from setting."})};return(o,t)=>{const i=I("icon-download");return p(),c("div",k,[e("div",B,[e("div",D,[e("div",F,[e("div",j,[e("div",N,[x(i,{class:"rotate-18"})]),t[1]||(t[1]=l(" Import Staff "))]),t[2]||(t[2]=e("div",{class:"right"},[e("div",{class:"text text-grey"})],-1))]),e("div",A,[e("div",R,[s.progressStatus?(p(),c("div",q,[e("div",L,[e("div",{class:"cssProgress-bar cssProgress-active","data-percent":s.uploadPercentage,style:P({width:s.uploadPercentage+"%"})},[e("span",T,O(s.uploadPercentage)+"%",1)],12,M)])])):C("",!0),t[6]||(t[6]=e("h4",{class:"mb-16"},"Import Staff Data",-1)),e("div",E,[t[3]||(t[3]=l(" If the university or SCHOOL is aware of these cases, they can monitor the ")),e("a",{class:"text-primary text-small f-w-bold pointer",onClick:V(v,["prevent"])},"Download CSV File"),t[4]||(t[4]=l(" & Upload it where threats found "))]),e("label",H,[e("input",{type:"file",id:"list",class:"d-none",accept:".zip",onChange:t[0]||(t[0]=a=>u(a))},null,32),t[5]||(t[5]=e("div",{class:"btn white-btn"},"Upload ZIP File",-1))])])])])])])}}};export{Z as default};
